---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

import { Content as IntroContent } from './_intro.md';

const posts = (await getCollection("posts", ({ data }) => {
    return import.meta.env.PROD ? data.draft !== true : true;
})).sort(
    (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<BaseLayout title="Blog" description="Minhas resenhas e pensamentos">
    <section>
        <div class="mb-10 text-[#657b83] dark:text-[#93a1a1]">
            <IntroContent />
        </div>

        <ul class="flex flex-col gap-6 list-none p-0">
            {posts.map((post) => (
                <li class="flex flex-col">
                    <div class="flex justify-between items-baseline gap-4 w-full">
                        <a
                            href={`/blog/${post.id}/`}
                            class="
                                /* Mobile: text-sm | Desktop: text-lg */
                                text-sm sm:text-lg font-medium font-jetbrains

                                /* CORES BASE: Azul Solarized */
                                text-[#268bd2] dark:text-[#268bd2]

                                /* CORES HOVER: Magenta Solarized */
                                hover:text-[#d33682] dark:hover:text-[#d33682]

                                transition-colors
                                hover:underline decoration-1 underline-offset-2
                            "
                        >
                            {post.data.title}
                        </a>
                            {post.data.draft && (
                                /* Rascunho com a cor de Aviso (Laranja Solarized) */
                                <span class="text-xs sm:text-sm text-[#cb4b16] dark:text-[#cb4b16] ml-2 font-jetbrains no-underline">
                                    [RASCUNHO]
                                </span>
                            )}

                        <time
                            datetime={post.data.date.toISOString()}
                            class="
                                /* Mobile: text-xs | Desktop: text-sm */
                                text-xs sm:text-sm
                                /* Datas mutadas (base1/base01) */
                                text-[#93a1a1] dark:text-[#586e75] font-jetbrains whitespace-nowrap
                            "
                        >
                            {post.data.date.toLocaleDateString('pt-BR', {
                                day: '2-digit',
                                month: 'short',
                                year: 'numeric',
                            })}
                        </time>
                    </div>

                    {post.data.tags && (
                        /* Tags com cor mutada, mas mantendo o # colorido para dar vida */
                        <div class="flex gap-3 mt-1 text-xs sm:text-sm font-jetbrains text-[#93a1a1] dark:text-[#586e75]">
                            {post.data.tags.map((tag) => (
                                <span>
                                    <span class="text-[#d33682] dark:text-[#d33682]">#</span>{tag}
                                </span>
                            ))}
                        </div>
                    )}
                </li>
            ))}
        </ul>
    </section>
</BaseLayout>
